var home=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function s(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function l(e){e.parentNode.removeChild(e)}function u(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function i(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function m(){return f(" ")}function g(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function d(e){return function(t){return t.preventDefault(),e.call(this,t)}}function h(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function p(e,t){t=""+t,e.data!==t&&(e.data=t)}function y(e,t){(null!=t||e.value)&&(e.value=t)}function v(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function b(e,t,n){e.classList[n?"add":"remove"](t)}let _;function w(e){_=e}const $=[],O=[],j=[],k=[],x=Promise.resolve();let S=!1;function T(e){j.push(e)}function E(){const e=new Set;do{for(;$.length;){const e=$.shift();w(e),q(e.$$)}for(;O.length;)O.pop()();for(let t=0;t<j.length;t+=1){const n=j[t];e.has(n)||(n(),e.add(n))}j.length=0}while($.length);for(;k.length;)k.pop()();S=!1}function q(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(T)}}const I=new Set;function C(e,t){-1===e.$$.dirty[0]&&($.push(e),S||(S=!0,x.then(E)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function D(r,a,c,l,u,i,f=[-1]){const m=_;w(r);const g=a.props||{},d=r.$$={fragment:null,ctx:null,props:i,update:e,not_equal:u,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(m?m.$$.context:[]),callbacks:n(),dirty:f};let h=!1;var p,y;d.ctx=c?c(r,g,(e,t,n=t)=>(d.ctx&&u(d.ctx[e],d.ctx[e]=n)&&(d.bound[e]&&d.bound[e](n),h&&C(r,e)),t)):[],d.update(),h=!0,o(d.before_update),d.fragment=!!l&&l(d.ctx),a.target&&(a.hydrate?d.fragment&&d.fragment.l(function(e){return Array.from(e.childNodes)}(a.target)):d.fragment&&d.fragment.c(),a.intro&&((p=r.$$.fragment)&&p.i&&(I.delete(p),p.i(y))),function(e,n,r){const{fragment:a,on_mount:c,on_destroy:l,after_update:u}=e.$$;a&&a.m(n,r),T(()=>{const n=c.map(t).filter(s);l?l.push(...n):o(n),e.$$.on_mount=[]}),u.forEach(T)}(r,a.target,a.anchor),E()),w(m)}function N(e,t,n){const o=e.slice();return o[27]=t[n],o}function H(e,t,n){const o=e.slice();return o[30]=t[n],o[32]=n,o}function L(e){let t,n,o,s,r,u,g,d,y,b=e[30].name+"",_=e[30].last_msg+"";return{c(){t=i("div"),n=i("ul"),o=i("li"),s=f(b),r=m(),u=i("li"),g=f(_),d=m(),h(o,"class","header svelte-b7etu6"),h(u,"class","msg svelte-b7etu6"),v(n,"list-style-type","none"),h(t,"class","convo_box svelte-b7etu6"),h(t,"style",y=e[32]%2==0?"background-color:#ddd":"")},m(e,l){c(e,t,l),a(t,n),a(n,o),a(o,s),a(n,r),a(n,u),a(u,g),a(t,d)},p(e,t){1&t[0]&&b!==(b=e[30].name+"")&&p(s,b),1&t[0]&&_!==(_=e[30].last_msg+"")&&p(g,_)},d(e){e&&l(t)}}}function M(e){let t,n,o,s,r,u,m,g=e[27].time+"",d=e[27].sender+"",y=e[27].contents+"";return{c(){t=i("li"),n=f(g),o=f("@"),s=f(d),r=f("> "),u=f(y),h(t,"style",m=e[27].from_you?"color:#f55;":"")},m(e,l){c(e,t,l),a(t,n),a(t,o),a(t,s),a(t,r),a(t,u)},p(e,o){2&o[0]&&g!==(g=e[27].time+"")&&p(n,g),2&o[0]&&d!==(d=e[27].sender+"")&&p(s,d),2&o[0]&&y!==(y=e[27].contents+"")&&p(u,y),2&o[0]&&m!==(m=e[27].from_you?"color:#f55;":"")&&h(t,"style",m)},d(e){e&&l(t)}}}function P(t){let n,s,r,p,_,w,$,O,j,k,x,S,T,E,q,I,C,D,P,A,R,J,K,X,B,U,Y,z,F=t[0],G=[];for(let e=0;e<F.length;e+=1)G[e]=L(H(t,F,e));let Q=t[1],V=[];for(let e=0;e<Q.length;e+=1)V[e]=M(N(t,Q,e));return{c(){n=i("div"),s=m(),r=i("div"),p=i("form"),_=f("User(s):"),w=i("input"),$=f("\n\t\tChat Name:"),O=i("input"),j=m(),k=i("button"),k.textContent="Create Chat",x=m(),S=i("div"),T=i("div"),E=i("div"),q=i("button"),q.textContent="+",I=m(),C=i("div");for(let e=0;e<G.length;e+=1)G[e].c();D=m(),P=i("div"),A=i("div"),R=i("ul");for(let e=0;e<V.length;e+=1)V[e].c();J=m(),K=i("div"),X=i("form"),B=i("input"),U=m(),Y=i("input"),h(n,"class","greyout_overlay svelte-b7etu6"),b(n,"grey_show",t[4]),h(w,"type","text"),h(w,"placeholder","steve85, joeseph42, ..."),h(O,"type","text"),h(O,"placeholder","friday sesh"),h(k,"type","submit"),h(r,"class","add_convo_form_wrapper svelte-b7etu6"),b(r,"show",t[4]),h(q,"class","svelte-b7etu6"),h(E,"class","add_convo_wrapper svelte-b7etu6"),h(C,"class","conversation_wrapper svelte-b7etu6"),h(T,"class","column left svelte-b7etu6"),v(R,"list-style-type","none"),h(A,"class","messages svelte-b7etu6"),h(B,"type","text"),h(B,"class","message_input svelte-b7etu6"),h(Y,"type","submit"),v(Y,"display","none"),v(X,"height","100%"),h(K,"class","input_area svelte-b7etu6"),h(P,"class","column right svelte-b7etu6"),h(S,"class","row svelte-b7etu6"),z=[g(n,"click",t[9]),g(w,"input",t[23]),g(O,"input",t[24]),g(p,"submit",d(t[10])),g(q,"click",t[8]),g(B,"input",t[26]),g(X,"submit",d(t[7]))]},m(e,o){c(e,n,o),c(e,s,o),c(e,r,o),a(r,p),a(p,_),a(p,w),y(w,t[5]),a(p,$),a(p,O),y(O,t[6]),a(p,j),a(p,k),c(e,x,o),c(e,S,o),a(S,T),a(T,E),a(E,q),a(T,I),a(T,C);for(let e=0;e<G.length;e+=1)G[e].m(C,null);a(S,D),a(S,P),a(P,A),a(A,R);for(let e=0;e<V.length;e+=1)V[e].m(R,null);t[25](A),a(P,J),a(P,K),a(K,X),a(X,B),y(B,t[3]),a(X,U),a(X,Y)},p(e,t){if(16&t[0]&&b(n,"grey_show",e[4]),32&t[0]&&w.value!==e[5]&&y(w,e[5]),64&t[0]&&O.value!==e[6]&&y(O,e[6]),16&t[0]&&b(r,"show",e[4]),1&t[0]){let n;for(F=e[0],n=0;n<F.length;n+=1){const o=H(e,F,n);G[n]?G[n].p(o,t):(G[n]=L(o),G[n].c(),G[n].m(C,null))}for(;n<G.length;n+=1)G[n].d(1);G.length=F.length}if(2&t[0]){let n;for(Q=e[1],n=0;n<Q.length;n+=1){const o=N(e,Q,n);V[n]?V[n].p(o,t):(V[n]=M(o),V[n].c(),V[n].m(R,null))}for(;n<V.length;n+=1)V[n].d(1);V.length=Q.length}8&t[0]&&B.value!==e[3]&&y(B,e[3])},i:e,o:e,d(e){e&&l(n),e&&l(s),e&&l(r),e&&l(x),e&&l(S),u(G,e),u(V,e),t[25](null),o(z)}}}function A(e,t,n){const o=localStorage.getItem("authToken"),s=localStorage.getItem("publicKey"),r=localStorage.getItem("privateKey"),a=(e,t)=>(console.log(t),console.log(e),new Promise((n,o)=>{let s=new XMLHttpRequest;s.open("POST",t,!0),s.setRequestHeader("Content-Type","application/json"),s.send(JSON.stringify(e)),s.onreadystatechange=()=>{if(s.readyState!=XMLHttpRequest.DONE)return;200!==s.status&&o(new Error("Error "+s.status.toString())),console.log(s.response);let e=JSON.parse(s.response);e.hasOwnProperty("error")&&o(new Error(e.error)),n(e)}}).catch(e=>{console.error(e.message)}));let c=localStorage.getItem("username");if(null==c){(async()=>{let e=a({authToken:o},"/user_req");try{c=await e}catch(e){console.error(e.message)}})()}let l=[];const u={id:-1,name:"default_name",last_msg:"default_msg",keys:{}};let i=[];const f={sender:"username-here",contents:"contents of message goes here",time:"formatted time string goes here",from_you:!1};let m,g;const d=()=>{const e=new Date;return(1900+e.getYear()).toString()+"-"+("0"+(1+e.getMonth()).toString()).slice(-2)+"-"+e.getDate().toString()+" "+("0"+e.getHours().toString()).slice(-2)+":"+("0"+e.getMinutes().toString()).slice(-2)+":"+("0"+e.getSeconds().toString()).slice(-2)},h=async()=>{let e,t={authToken:o},s=a(t,"/convo_req");try{e=await s}catch(e){return void console.error(e.message)}for(let n=0;n<e.conversationObjects.length;n++){let r,c=Object.create(u);c.id=e.conversationObjects[n].id,c.name=e.conversationObjects[n].name,c.last_msg=e.conversationObjects[n].last_msg_digest,t={authToken:o,conversationID:c.id},s=a(t,"/keys_req");try{r=await s}catch(e){console.error(e.message);continue}c.keys=r,l.push(c)}n(0,l),console.log(l)};h();let p=!1;let y,v;let b=Object.create(u);return b.id=0,b.name="a better convo name",b.last_msg="a cool message",l.push(b),b=Object.create(u),b.id=1,b.name="wayy better",b.last_msg="a cooler message",l.push(b),b=Object.create(u),b.id=1,b.name="convo 3",b.last_msg="message goes here",l.push(b),b=Object.create(u),b.id=1,b.name="convo 4",b.last_msg="giberish",l.push(b),b=Object.create(f),b.sender="seamooo",b.contents="wow awesome message you got there",b.time="1997-03-11 11:20:24",b.from_you=!0,i.push(b),b=Object.create(f),b.sender="other",b.contents="average message",b.time="1997-03-11 11:20:30",b.from_you=!1,i.push(b),b=Object.create(f),b.sender="seamooo",b.contents="ehh it was kinda cool I guess",b.time="1997-03-11 11:20:40",b.from_you=!0,i.push(b),b=Object.create(f),b.sender="other",b.contents="yeah whatever",b.time="1997-03-11 11:20:50",b.from_you=!1,i.push(b),l=l,i=i,[l,i,m,g,p,y,v,()=>{let e=Object.create(f);e.sender=c,e.contents=g,e.time=d(),e.from_you=!0,i.push(e),n(1,i),n(3,g=""),n(2,m.scrollTop=m.scrollHeight,m)},()=>{n(4,p=!0)},()=>{n(4,p=!1)},async()=>{let e=y.replace(/ /g,"").split(",");e.push(c);let t={authToken:o,participants:e};v.length>0&&(t.name=v);let s,r=a(t,"/conversation_create");try{s=await r}catch(e){return void alert(e.message)}console.log("here");const i=s.conversationID,f=s.name;t={authToken:o,conversationID:i},r=a(t,"/keys_req");try{s=await r}catch(e){return void alert(e.message)}const m=s;t={authToken:o,conversationID:i},r=a(t,"/last_msg_req");try{s=await r}catch(e){return void alert(e.message)}const g=s.digest,d=Object.create(u);d.id=i,d.name=f,d.last_msg=g,d.keys=m,l.unshift(d),n(0,l),n(4,p=!1)},c,b,o,s,r,a,u,f,void 0,d,{id:-1,digest:"deadd0d0"},h,function(){y=this.value,n(5,y)},function(){v=this.value,n(6,v)},function(e){O[e?"unshift":"push"](()=>{n(2,m=e)})},function(){g=this.value,n(3,g)}]}return new class extends class{$destroy(){!function(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}{constructor(e){super(),D(this,e,A,P,r,{},[-1,-1])}}({target:document.body,props:{}})}();
//# sourceMappingURL=home.js.map
