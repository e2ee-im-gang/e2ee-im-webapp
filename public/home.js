var home=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function s(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function l(e){e.parentNode.removeChild(e)}function i(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function d(e){return document.createTextNode(e)}function f(){return d(" ")}function g(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function p(e){return function(t){return t.preventDefault(),e.call(this,t)}}function h(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function m(e,t){t=""+t,e.data!==t&&(e.data=t)}function y(e,t){(null!=t||e.value)&&(e.value=t)}function v(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function _(e,t,n){e.classList[n?"add":"remove"](t)}let b;function x(e){b=e}const w=[],$=[],k=[],O=[],S=Promise.resolve();let j=!1;function z(e){k.push(e)}function D(){const e=new Set;do{for(;w.length;){const e=w.shift();x(e),T(e.$$)}for(;$.length;)$.pop()();for(let t=0;t<k.length;t+=1){const n=k[t];e.has(n)||(n(),e.add(n))}k.length=0}while(w.length);for(;O.length;)O.pop()();j=!1}function T(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(z)}}const I=new Set;function q(e,t){-1===e.$$.dirty[0]&&(w.push(e),j||(j=!0,S.then(D)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function E(r,a,c,l,i,u,d=[-1]){const f=b;x(r);const g=a.props||{},p=r.$$={fragment:null,ctx:null,props:u,update:e,not_equal:i,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:n(),dirty:d};let h=!1;var m,y;p.ctx=c?c(r,g,(e,t,n=t)=>(p.ctx&&i(p.ctx[e],p.ctx[e]=n)&&(p.bound[e]&&p.bound[e](n),h&&q(r,e)),t)):[],p.update(),h=!0,o(p.before_update),p.fragment=!!l&&l(p.ctx),a.target&&(a.hydrate?p.fragment&&p.fragment.l(function(e){return Array.from(e.childNodes)}(a.target)):p.fragment&&p.fragment.c(),a.intro&&((m=r.$$.fragment)&&m.i&&(I.delete(m),m.i(y))),function(e,n,r){const{fragment:a,on_mount:c,on_destroy:l,after_update:i}=e.$$;a&&a.m(n,r),z(()=>{const n=c.map(t).filter(s);l?l.push(...n):o(n),e.$$.on_mount=[]}),i.forEach(z)}(r,a.target,a.anchor),D()),x(f)}function C(e,t,n){const o=e.slice();return o[33]=t[n],o}function N(e,t,n){const o=e.slice();return o[36]=t[n],o[38]=n,o}function K(e){let t,n,o,s,r,i,p,y,_,b,x,w,$,k,O=e[36].name+"",S=e[36].last_msg+"";return{c(){t=u("label"),n=u("div"),o=u("input"),r=f(),i=u("ul"),p=u("li"),y=d(O),_=f(),b=u("li"),x=d(S),$=f(),h(o,"type","radio"),h(o,"class","convo_radio_wrapper svelte-1xapz62"),o.__value=s=e[38],o.value=o.__value,e[30][0].push(o),h(p,"class","header svelte-1xapz62"),h(b,"class","msg svelte-1xapz62"),v(i,"list-style-type","none"),h(n,"class","convo_box svelte-1xapz62"),h(n,"style",w=e[38]==e[7]?"background-color:#cef":e[38]%2==0?"background-color:#ddd":""),k=g(o,"change",e[29])},m(s,l){c(s,t,l),a(t,n),a(n,o),o.checked=o.__value===e[7],a(n,r),a(n,i),a(i,p),a(p,y),a(i,_),a(i,b),a(b,x),a(t,$)},p(e,t){128&t[0]&&(o.checked=o.__value===e[7]),1&t[0]&&O!==(O=e[36].name+"")&&m(y,O),1&t[0]&&S!==(S=e[36].last_msg+"")&&m(x,S),128&t[0]&&w!==(w=e[38]==e[7]?"background-color:#cef":e[38]%2==0?"background-color:#ddd":"")&&h(n,"style",w)},d(n){n&&l(t),e[30][0].splice(e[30][0].indexOf(o),1),k()}}}function H(e){let t,n,o,s,r,i,f,g=e[33].time+"",p=e[33].sender+"",y=e[33].contents+"";return{c(){t=u("li"),n=d(g),o=d("@"),s=d(p),r=d("> "),i=d(y),h(t,"style",f=e[33].from_you?"color:#f55;":"")},m(e,l){c(e,t,l),a(t,n),a(t,o),a(t,s),a(t,r),a(t,i)},p(e,o){2&o[0]&&g!==(g=e[33].time+"")&&m(n,g),2&o[0]&&p!==(p=e[33].sender+"")&&m(s,p),2&o[0]&&y!==(y=e[33].contents+"")&&m(i,y),2&o[0]&&f!==(f=e[33].from_you?"color:#f55;":"")&&h(t,"style",f)},d(e){e&&l(t)}}}function L(t){let n,s,r,m,b,x,w,$,k,O,S,j,z,D,T,I,q,E,L,M,P,A,R,J,X,B,U,Y,F=t[0],G=[];for(let e=0;e<F.length;e+=1)G[e]=K(N(t,F,e));let Q=t[1],V=[];for(let e=0;e<Q.length;e+=1)V[e]=H(C(t,Q,e));return{c(){n=u("div"),s=f(),r=u("div"),m=u("form"),b=d("User(s):"),x=u("input"),w=d("\n\t\tChat Name:"),$=u("input"),k=f(),O=u("button"),O.textContent="Create Chat",S=f(),j=u("div"),z=u("div"),D=u("div"),T=u("button"),T.textContent="+",I=f(),q=u("div");for(let e=0;e<G.length;e+=1)G[e].c();E=f(),L=u("div"),M=u("div"),P=u("ul");for(let e=0;e<V.length;e+=1)V[e].c();A=f(),R=u("div"),J=u("form"),X=u("input"),B=f(),U=u("input"),h(n,"class","greyout_overlay svelte-1xapz62"),_(n,"grey_show",t[4]),h(x,"type","text"),h(x,"placeholder","steve85, joeseph42, ..."),h($,"type","text"),h($,"placeholder","friday sesh"),h(O,"type","submit"),h(r,"class","add_convo_form_wrapper svelte-1xapz62"),_(r,"show",t[4]),h(T,"class","svelte-1xapz62"),h(D,"class","add_convo_wrapper svelte-1xapz62"),h(q,"class","conversation_wrapper svelte-1xapz62"),h(z,"class","column left svelte-1xapz62"),v(P,"list-style-type","none"),h(M,"class","messages svelte-1xapz62"),h(X,"type","text"),h(X,"class","message_input svelte-1xapz62"),h(U,"type","submit"),v(U,"display","none"),v(J,"height","100%"),h(R,"class","input_area svelte-1xapz62"),h(L,"class","column right svelte-1xapz62"),h(j,"class","row svelte-1xapz62"),Y=[g(n,"click",t[9]),g(x,"input",t[27]),g($,"input",t[28]),g(m,"submit",p(t[10])),g(T,"click",t[8]),g(X,"input",t[32]),g(J,"submit",p(t[11]))]},m(e,o){c(e,n,o),c(e,s,o),c(e,r,o),a(r,m),a(m,b),a(m,x),y(x,t[5]),a(m,w),a(m,$),y($,t[6]),a(m,k),a(m,O),c(e,S,o),c(e,j,o),a(j,z),a(z,D),a(D,T),a(z,I),a(z,q);for(let e=0;e<G.length;e+=1)G[e].m(q,null);a(j,E),a(j,L),a(L,M),a(M,P);for(let e=0;e<V.length;e+=1)V[e].m(P,null);t[31](M),a(L,A),a(L,R),a(R,J),a(J,X),y(X,t[3]),a(J,B),a(J,U)},p(e,t){if(16&t[0]&&_(n,"grey_show",e[4]),32&t[0]&&x.value!==e[5]&&y(x,e[5]),64&t[0]&&$.value!==e[6]&&y($,e[6]),16&t[0]&&_(r,"show",e[4]),129&t[0]){let n;for(F=e[0],n=0;n<F.length;n+=1){const o=N(e,F,n);G[n]?G[n].p(o,t):(G[n]=K(o),G[n].c(),G[n].m(q,null))}for(;n<G.length;n+=1)G[n].d(1);G.length=F.length}if(2&t[0]){let n;for(Q=e[1],n=0;n<Q.length;n+=1){const o=C(e,Q,n);V[n]?V[n].p(o,t):(V[n]=H(o),V[n].c(),V[n].m(P,null))}for(;n<V.length;n+=1)V[n].d(1);V.length=Q.length}8&t[0]&&X.value!==e[3]&&y(X,e[3])},i:e,o:e,d(e){e&&l(n),e&&l(s),e&&l(r),e&&l(S),e&&l(j),i(G,e),i(V,e),t[31](null),o(Y)}}}function M(e,t,n){const o=localStorage.getItem("authToken"),s=localStorage.getItem("publicKey"),r=localStorage.getItem("privateKey"),a=(e,t)=>(console.log(t),new Promise((n,o)=>{let s=new XMLHttpRequest;s.open("POST",t,!0),s.setRequestHeader("Content-Type","application/json"),s.send(JSON.stringify(e)),s.onreadystatechange=()=>{if(s.readyState!=XMLHttpRequest.DONE)return;200!==s.status&&o(new Error("Error "+s.status.toString()));let e=JSON.parse(s.response);e.hasOwnProperty("error")&&o(new Error(e.error)),n(e)}}).catch(e=>{console.error(e.message)}));let c=localStorage.getItem("username");if(null==c){(async()=>{let e=a({authToken:o},"/user_req");try{c=await e}catch(e){console.error(e.message)}})()}let l=[];const i={id:-1,name:"default_name",last_msg:"default_msg",keys:{}};let u=[];const d={sender:"username-here",contents:"contents of message goes here",time:"formatted time string goes here",from_you:!1};let f,g;const p=e=>(1900+e.getYear()).toString()+"-"+("0"+(1+e.getMonth()).toString()).slice(-2)+"-"+e.getDate().toString()+" "+("0"+e.getHours().toString()).slice(-2)+":"+("0"+e.getMinutes().toString()).slice(-2)+":"+("0"+e.getSeconds().toString()).slice(-2),h=async()=>{let e,t={authToken:o},s=a(t,"/convo_req");try{e=await s}catch(e){return void console.error(e.message)}for(let n=0;n<e.conversationObjects.length;n++){let r,c=Object.create(i);c.id=e.conversationObjects[n].id,c.name=e.conversationObjects[n].name,c.last_msg=e.conversationObjects[n].last_msg_digest,t={authToken:o,conversationID:c.id},s=a(t,"/keys_req");try{r=await s}catch(e){console.error(e.message);continue}c.keys=r,l.push(c)}n(0,l)};h();let m=!1;let y,v;let _=-1;const b=async e=>{let t,s=a({authToken:o,conversationID:e},"/messages_req");try{t=await s}catch(e){return void alert(e.message)}n(1,u=[]);let r=t.messageObjects;for(let e=0;e<r.length;e++){let t=Object.create(d);t.sender=r[e].sender,t.contents=r[e].digest,t.time=p(new Date(r[e].time)),t.from_you=c==r[e].sender,u.push(t)}n(1,u)},x=e=>{-1!=e&&(n(0,l),b(l[e].id))},w=async(e,t)=>{const n={authToken:o,conversationID:e.id,digests:{userDigests:[],deviceDigests:[]}};console.log(e);for(let o=0;o<e.keys.userKeys.length;o++)n.digests.userDigests.push({id:e.keys.userKeys[o].id,digest:t});for(let o=0;o<e.keys.deviceKeys.length;o++)n.digests.deviceDigests.push({id:e.keys.deviceKeys[o].id,digest:t});let s,r=a(n,"/msg_create");try{s=await r}catch(e){return void alert(e.message)}};let k=Object.create(d);k.sender="seamooo",k.contents="wow awesome message you got there",k.time="1997-03-11 11:20:24",k.from_you=!0,u.push(k),k=Object.create(d),k.sender="other",k.contents="average message",k.time="1997-03-11 11:20:30",k.from_you=!1,u.push(k),k=Object.create(d),k.sender="seamooo",k.contents="ehh it was kinda cool I guess",k.time="1997-03-11 11:20:40",k.from_you=!0,u.push(k),k=Object.create(d),k.sender="other",k.contents="yeah whatever",k.time="1997-03-11 11:20:50",k.from_you=!1,u.push(k),l=l,u=u;return e.$$.update=()=>{128&e.$$.dirty[0]&&x(_)},[l,u,f,g,m,y,v,_,()=>{n(4,m=!0)},()=>{n(4,m=!1)},async()=>{let e=y.replace(/ /g,"").split(",");e.push(c);let t={authToken:o,participants:e};v.length>0&&(t.name=v);let s,r=a(t,"/conversation_create");try{s=await r}catch(e){return void alert(e.message)}const u=s.conversationID,d=s.name;t={authToken:o,conversationID:u},r=a(t,"/keys_req");try{s=await r}catch(e){return void alert(e.message)}const f=s;t={authToken:o,conversationID:u},r=a(t,"/last_msg_req");try{s=await r}catch(e){return void alert(e.message)}const g=s.digest,p=Object.create(i);p.id=u,p.name=d,p.last_msg=g,p.keys=f,l.unshift(p),n(0,l),n(4,m=!1)},()=>{let e=l[_],t=Object.create(d);w(e,g),t.sender=c,t.contents=g,t.time=p(new Date),t.from_you=!0,u.push(t),n(1,u),n(3,g=""),n(2,f.scrollTop=f.scrollHeight,f)},c,k,o,s,r,a,i,d,void 0,p,{id:-1,digest:"deadd0d0"},h,b,x,w,function(){y=this.value,n(5,y)},function(){v=this.value,n(6,v)},function(){_=this.__value,n(7,_)},[[]],function(e){$[e?"unshift":"push"](()=>{n(2,f=e)})},function(){g=this.value,n(3,g)}]}return new class extends class{$destroy(){!function(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}{constructor(e){super(),E(this,e,M,L,r,{},[-1,-1])}}({target:document.body,props:{}})}();
//# sourceMappingURL=home.js.map
